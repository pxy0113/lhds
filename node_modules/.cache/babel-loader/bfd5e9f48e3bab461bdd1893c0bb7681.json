{"remainingRequest":"F:\\work\\lhds\\node_modules\\thread-loader\\dist\\cjs.js!F:\\work\\lhds\\node_modules\\babel-loader\\lib\\index.js!F:\\work\\lhds\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\work\\lhds\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\work\\lhds\\src\\components\\common\\Ubox.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\work\\lhds\\src\\components\\common\\Ubox.vue","mtime":1575358194342},{"path":"F:\\work\\lhds\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\work\\lhds\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\work\\lhds\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\work\\lhds\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\work\\lhds\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.number.constructor\";\nimport _defineProperty from \"F:\\\\work\\\\lhds\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/defineProperty\";\nimport \"core-js/modules/web.dom.iterable\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Utils from '@/plugins/cryAes.js';\nimport { mapActions } from 'vuex';\nimport wait from '@/components/other/wait/Wait.vue';\nimport { scrollMixins } from '@/mixins/scroll.js';\nexport default {\n  mixins: [scrollMixins],\n  components: {\n    wait: wait\n  },\n  data: function data() {\n    return {\n      testPage: 1,\n      testSize: 3,\n      transition: 'scale-transition',\n      loading: true,\n      //控制骨架屏 true表示显示\n      target: '#sRow',\n      options: {\n        duration: 1000,\n        offset: 0,\n        easing: 'easeInOutCubic'\n      },\n      curPage: {\n        page: 1,\n        size: 0\n      },\n      valid: true,\n      news: {\n        A1: '',\n        A2: '',\n        A3: '',\n        A4: 0.1,\n        A5: 0\n      },\n      newsPassword: '',\n      //交易所为OKex时特定字段\n      place: '',\n      //当前选中的交易所\n      items: [],\n      //交易所对应的买入/卖出费率数据\n      addDialog: false,\n      apiColumns: [{\n        text: '名称',\n        align: 'center',\n        sortable: false,\n        value: 'exchange'\n      }, {\n        text: '备注',\n        align: 'center',\n        sortable: false,\n        value: 'remark'\n      }, {\n        text: 'API KEY',\n        align: 'center',\n        sortable: false,\n        value: 'key'\n      }, {\n        text: 'API SECRET',\n        align: 'center',\n        sortable: false,\n        value: 'secret'\n      }, {\n        text: '买入费率(%)',\n        align: 'center',\n        sortable: false,\n        value: 'buy'\n      }, {\n        text: '卖出费率(%)',\n        align: 'center',\n        sortable: false,\n        value: 'sell'\n      }, {\n        text: '操作',\n        align: 'center',\n        sortable: false,\n        value: 'del'\n      }],\n      apiList: [],\n      rules: {\n        required: function required(v) {\n          return !!v || '必填';\n        },\n        length: function length(v) {\n          return v && v.length <= 68 || '超出长度';\n        },\n        size: function size(v) {\n          return v > 0 || '必须大于0';\n        },\n        isEmpty: function isEmpty(v) {\n          return /\\S/.test(v) || '不可为空';\n        },\n        not: function not(v) {\n          return !/[\\u4E00-\\u9FA5]/g.test(v) || '不能是中文';\n        }\n      }\n    };\n  },\n  watch: {\n    place: {\n      handler: function handler(newV, oldV) {\n        var _this = this;\n\n        this.items.forEach(function (item) {\n          if (item.exc == newV) {\n            _this.news.A4 = item.buy;\n            _this.news.A5 = item.sell;\n          }\n        });\n      },\n      immediate: true\n    },\n    wssData: {\n      handler: function handler(nV, oV) {\n        this.getMessage();\n      },\n      deep: true\n    },\n    addDialog: {\n      handler: function handler(nV, oV) {\n        nV && this.afterOpen(); //mixins不允许滚动\n\n        !nV && this.beforeClose();\n      },\n      immediate: true\n    }\n  },\n  computed: {\n    wssData: function wssData() {\n      //wss传递的消息\n      return this.$store.state.collocationList;\n    }\n  },\n  mounted: function mounted() {\n    var _this2 = this;\n\n    if (sessionStorage.apiPublic) {\n      this.items = JSON.parse(sessionStorage.apiPublic);\n      this.place = this.items.length > 0 ? this.items[0].exc : '';\n    } else {\n      $ax.getTestData('/EasWebUser/getAPIData', {}, function (res) {\n        if (res.code == 1) {\n          sessionStorage.apiPublic = JSON.stringify(res.data);\n          _this2.items = res.data;\n          _this2.place = _this2.items.length > 0 ? _this2.items[0].exc : '';\n        }\n      });\n    }\n\n    this.getApiList(1);\n  },\n  beforeRouteLeave: function beforeRouteLeave(to, from, next) {\n    //路由离开前断开\n    this.$sock.close();\n    next(); //跳转路由\n  },\n  methods: _objectSpread({}, mapActions(['changeLay', 'changeSnack']), {\n    transUpperCase: function transUpperCase(data) {\n      //交易对转大写\n      return data.toUpperCase();\n    },\n    inputShow: function inputShow(number) {\n      //点击野马\n      this.curPage.page = number;\n      this.getApiList();\n    },\n    changeTime: function changeTime(time) {\n      return this.$utils.timestampToTime(Number(time));\n    },\n    getMessage: function getMessage() {\n      //wss传递的消息\n      var result = this.wssData;\n\n      switch (result.code) {\n        case 20013:\n          //客户端在线\n          this.sendMsgToClient();\n          break;\n\n        default:\n          break;\n      }\n    },\n    delApi: function delApi(item) {\n      var _this3 = this;\n\n      this.$xyDialog({\n        title: '删除API',\n        content: '确定删除吗? 该操作不可撤销',\n        onOk: function onOk() {\n          _this3.changeLay(true);\n\n          $ax.getAjaxData('/EasWebUser/delAPI', {\n            id: item.id\n          }, function (res) {\n            _this3.changeLay(false);\n\n            if (res.code == 1) {\n              var msg = {\n                state: true,\n                errorText: {\n                  type: 'success',\n                  text: '删除成功'\n                }\n              };\n\n              _this3.changeSnack(msg);\n\n              var state = _this3.$sock.lookState();\n\n              state == -1 ? _this3.$sock.initWebSocket() : _this3.sendMsgToClient();\n\n              var index = _this3.apiList.indexOf(item);\n\n              sessionStorage.removeItem('collocation'); //删除api/rule的时候把存储的旧数据清空\n\n              _this3.apiList.splice(index, 1);\n            }\n          }, {\n            hasToken: true\n          });\n        }\n      });\n    },\n    closeAccount: function closeAccount() {\n      this.$refs.form.resetValidation();\n      this.addDialog = false;\n      this.news = this.$options.data().news;\n      this.newsPassword = '';\n      this.place = this.items.length > 0 ? this.items[0].exc : '';\n    },\n    addOneAccount: function addOneAccount() {\n      var _this4 = this;\n\n      //添加新账户\n      if (this.$refs.form.validate()) {\n        var other = {\n          A0: this.place,\n          A6: this.newsPassword,\n          A7: 0,\n          A8: 0,\n          A9: 0,\n          A10: 0\n        };\n        var obj = {\n          exc: this.place,\n          remark: this.news.A1,\n          data: Utils.encrypt(JSON.stringify(Object.assign({}, this.news, other)))\n        };\n        this.changeLay(true);\n        $ax.getAjaxData('/EasWebUser/addAPI', obj, function (res) {\n          _this4.changeLay(false);\n\n          if (res.code == 1) {\n            var msg = {\n              state: true,\n              errorText: {\n                type: 'success',\n                text: '添加成功'\n              }\n            };\n\n            _this4.changeSnack(msg);\n\n            var state = _this4.$sock.lookState();\n\n            state == -1 ? _this4.$sock.initWebSocket() : _this4.sendMsgToClient();\n            _this4.addDialog = false;\n\n            _this4.$refs.form.resetValidation();\n\n            _this4.news = _this4.$options.data().news;\n            sessionStorage.removeItem('collocation');\n\n            _this4.getApiList();\n          }\n        }, {\n          hasToken: true\n        });\n      }\n    },\n    sendMsgToClient: function sendMsgToClient() {\n      this.$sock.websocketsend(JSON.stringify({\n        code: 1006\n      }));\n    },\n    setLoading: function setLoading() {\n      var _this5 = this;\n\n      var num = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 2;\n      setTimeout(function () {\n        _this5.loading = false;\n        num == 2 && _this5.$vuetify.goTo(_this5.target, _this5.options); //平滑滚动到表头\n      }, 1000);\n    },\n    getApiList: function getApiList(num) {\n      var _this6 = this;\n\n      //获取api列表\n      this.loading = true;\n      $ax.getAjaxData('/EasWebUser/getAPI', {\n        pageSize: 10,\n        pageIndex: this.curPage.page\n      }, function (res) {\n        _this6.setLoading(num);\n\n        if (res.code == 1) {\n          _this6.apiList = res.data;\n          _this6.curPage = {\n            page: res.pageIndex,\n            size: res.pageMaxPage\n          };\n        } else {\n          console.log('错误错误');\n        }\n      }, {\n        hasToken: true\n      });\n    }\n  })\n};",null]}