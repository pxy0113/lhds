{"remainingRequest":"C:\\Users\\pxy\\Downloads\\test\\lhds\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\pxy\\Downloads\\test\\lhds\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\pxy\\Downloads\\test\\lhds\\src\\plugins\\socket.js","dependencies":[{"path":"C:\\Users\\pxy\\Downloads\\test\\lhds\\src\\plugins\\socket.js","mtime":1574768497316},{"path":"C:\\Users\\pxy\\Downloads\\test\\lhds\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1572955172692},{"path":"C:\\Users\\pxy\\Downloads\\test\\lhds\\node_modules\\babel-loader\\lib\\index.js","mtime":1572955171173},{"path":"C:\\Users\\pxy\\Downloads\\test\\lhds\\node_modules\\eslint-loader\\index.js","mtime":1572955195504}],"contextDependencies":[],"result":["var websock = null;\nvar state = -1;\nimport vuex from \"../store/index\";\nexport default {\n  initWebSocket: function initWebSocket() {\n    var _this = this;\n\n    //初始化weosocket\n    var token = sessionStorage.token;\n\n    if (token) {\n      var ds = window.encodeURIComponent(token); // const wsuri = `ws://192.168.2.105:8080/EasRobotWS/ws?token=${ds}`;\n\n      var wsuri = \"ws://ws.lhds.vip:8080/EasRobotWS/ws?token=\".concat(ds);\n      websock = new WebSocket(wsuri);\n      state = websock.readyState;\n\n      websock.onmessage = function (e) {\n        _this.websocketonmessage(e);\n      };\n\n      websock.onopen = function () {\n        _this.websocketonopen();\n      };\n\n      websock.onerror = function () {\n        console.log('失败了');\n      };\n\n      websock.onclose = function (e) {\n        _this.websocketclose(e);\n      };\n    }\n  },\n  websocketonmessage: function websocketonmessage(e) {\n    var result = JSON.parse(e.data);\n    console.log('收到数据 = >', result);\n    state = websock.readyState;\n    vuex.state.collocationList = result;\n  },\n  websocketonopen: function websocketonopen() {\n    console.log('打开websocket'); //this.websocketsend();\n\n    state = websock.readyState;\n  },\n  websocketclose: function websocketclose(e) {\n    //关闭\n    console.log('断开连接', e);\n    vuex.state.collocationList = [];\n    state = -1;\n  },\n  websocketsend: function websocketsend(Data) {\n    //数据发送\n    console.log('发送数据 = >', Data);\n    websock.send(Data);\n  },\n  close: function close() {\n    if (state >= 0) {\n      websock.close();\n      state = websock.readyState;\n    }\n  },\n  lookState: function lookState() {\n    //查询sock当前状态\n    return state;\n  }\n};",{"version":3,"sources":["C:\\Users\\pxy\\Downloads\\test\\lhds\\src\\plugins\\socket.js"],"names":["websock","state","vuex","initWebSocket","token","sessionStorage","ds","window","encodeURIComponent","wsuri","WebSocket","readyState","onmessage","e","websocketonmessage","onopen","websocketonopen","onerror","console","log","onclose","websocketclose","result","JSON","parse","data","collocationList","websocketsend","Data","send","close","lookState"],"mappings":"AAAC,IAAIA,OAAO,GAAG,IAAd;AAEA,IAAIC,KAAK,GAAG,CAAC,CAAb;AAEA,OAAOC,IAAP;AAEA,eAAc;AAEbC,EAAAA,aAFa,2BAEE;AAAA;;AAAE;AAChB,QAAIC,KAAK,GAAGC,cAAc,CAACD,KAA3B;;AAEA,QAAGA,KAAH,EAAS;AACR,UAAIE,EAAE,GAAGC,MAAM,CAACC,kBAAP,CAA0BJ,KAA1B,CAAT,CADQ,CAGR;;AACA,UAAMK,KAAK,uDAAgDH,EAAhD,CAAX;AAEAN,MAAAA,OAAO,GAAG,IAAIU,SAAJ,CAAcD,KAAd,CAAV;AAEAR,MAAAA,KAAK,GAAGD,OAAO,CAACW,UAAhB;;AAEAX,MAAAA,OAAO,CAACY,SAAR,GAAoB,UAACC,CAAD,EAAM;AACzB,QAAA,KAAI,CAACC,kBAAL,CAAwBD,CAAxB;AACA,OAFD;;AAGAb,MAAAA,OAAO,CAACe,MAAR,GAAiB,YAAK;AACrB,QAAA,KAAI,CAACC,eAAL;AACA,OAFD;;AAGAhB,MAAAA,OAAO,CAACiB,OAAR,GAAkB,YAAU;AAC3BC,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ;AACA,OAFD;;AAGAnB,MAAAA,OAAO,CAACoB,OAAR,GAAkB,UAACP,CAAD,EAAM;AACvB,QAAA,KAAI,CAACQ,cAAL,CAAoBR,CAApB;AACA,OAFD;AAGA;AACD,GA5BY;AA8BbC,EAAAA,kBA9Ba,8BA8BMD,CA9BN,EA8BQ;AACpB,QAAIS,MAAM,GAAGC,IAAI,CAACC,KAAL,CAAWX,CAAC,CAACY,IAAb,CAAb;AAEAP,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAuBG,MAAvB;AAEArB,IAAAA,KAAK,GAAGD,OAAO,CAACW,UAAhB;AAEAT,IAAAA,IAAI,CAACD,KAAL,CAAWyB,eAAX,GAA6BJ,MAA7B;AAEA,GAvCY;AAyCbN,EAAAA,eAzCa,6BAyCI;AAChBE,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EADgB,CAGhB;;AAEAlB,IAAAA,KAAK,GAAGD,OAAO,CAACW,UAAhB;AAEA,GAhDY;AAkDbU,EAAAA,cAlDa,0BAkDER,CAlDF,EAkDI;AAAG;AACnBK,IAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBN,CAApB;AAEAX,IAAAA,IAAI,CAACD,KAAL,CAAWyB,eAAX,GAA6B,EAA7B;AAEAzB,IAAAA,KAAK,GAAG,CAAC,CAAT;AACA,GAxDY;AA0Db0B,EAAAA,aA1Da,yBA0DCC,IA1DD,EA0DM;AAAC;AACnBV,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAuBS,IAAvB;AACA5B,IAAAA,OAAO,CAAC6B,IAAR,CAAaD,IAAb;AACA,GA7DY;AA+DbE,EAAAA,KA/Da,mBA+DN;AACN,QAAG7B,KAAK,IAAI,CAAZ,EAAc;AACbD,MAAAA,OAAO,CAAC8B,KAAR;AACA7B,MAAAA,KAAK,GAAGD,OAAO,CAACW,UAAhB;AACA;AAED,GArEY;AAsEboB,EAAAA,SAtEa,uBAsEF;AAAC;AACX,WAAO9B,KAAP;AACA;AAxEY,CAAd","sourcesContent":["\tvar websock = null;\r\n\r\n\tvar state = -1;\r\n\r\n\timport vuex from '../store/index'\r\n\r\n\texport default{\r\n\t\t\r\n\t\tinitWebSocket(){ //初始化weosocket\r\n\t\t\tlet token = sessionStorage.token;\r\n\t\t\t\r\n\t\t\tif(token){\r\n\t\t\t\tlet ds = window.encodeURIComponent(token);\r\n\t\t\t\t\r\n\t\t\t\t// const wsuri = `ws://192.168.2.105:8080/EasRobotWS/ws?token=${ds}`;\r\n\t\t\t\tconst wsuri = `ws://ws.lhds.vip:8080/EasRobotWS/ws?token=${ds}`;\r\n\t\t\t\t\r\n\t\t\t\twebsock = new WebSocket(wsuri);\r\n\t\t\t\t\r\n\t\t\t\tstate = websock.readyState;\r\n\t\t\t\t\r\n\t\t\t\twebsock.onmessage = (e) =>{\r\n\t\t\t\t\tthis.websocketonmessage(e);\r\n\t\t\t\t};\r\n\t\t\t\twebsock.onopen = () =>{\r\n\t\t\t\t\tthis.websocketonopen();\r\n\t\t\t\t};\r\n\t\t\t\twebsock.onerror = function(){\r\n\t\t\t\t\tconsole.log('失败了');\r\n\t\t\t\t};\r\n\t\t\t\twebsock.onclose = (e) =>{\r\n\t\t\t\t\tthis.websocketclose(e);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t\t\r\n\t\twebsocketonmessage(e){\r\n\t\t\tlet result = JSON.parse(e.data);\r\n\t\t\t\r\n\t\t\tconsole.log('收到数据 = >',result);\r\n\t\t\t\r\n\t\t\tstate = websock.readyState;\r\n\t\t\t\r\n\t\t\tvuex.state.collocationList = result;\r\n\r\n\t\t},\r\n\t\t\r\n\t\twebsocketonopen(){\r\n\t\t\tconsole.log('打开websocket');\r\n\r\n\t\t\t//this.websocketsend();\r\n\t\t\t\r\n\t\t\tstate = websock.readyState;\r\n\r\n\t\t},\r\n\t\t\r\n\t\twebsocketclose(e){  //关闭\r\n\t\t\tconsole.log('断开连接', e);\r\n\t\t\t\r\n\t\t\tvuex.state.collocationList = [];\r\n\t\t\t\r\n\t\t\tstate = -1;\r\n\t\t},\r\n\r\n\t\twebsocketsend(Data){//数据发送\r\n\t\t\tconsole.log('发送数据 = >',Data);\r\n\t\t\twebsock.send(Data);\r\n\t\t},\r\n\t\t\r\n\t\tclose(){\r\n\t\t\tif(state >= 0){\r\n\t\t\t\twebsock.close();\r\n\t\t\t\tstate = websock.readyState;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t},\r\n\t\tlookState(){//查询sock当前状态\r\n\t\t\treturn state;\r\n\t\t}\r\n\r\n\r\n\t\t\r\n\t}\t\t\r\n\t\t\t\t\r\n\r\n\t\t\t\t\r\n\t\t\t\t\r\n"]}]}