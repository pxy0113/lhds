{"remainingRequest":"F:\\work\\lhds\\node_modules\\babel-loader\\lib\\index.js!F:\\work\\lhds\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\work\\lhds\\src\\axios\\index.js","dependencies":[{"path":"F:\\work\\lhds\\src\\axios\\index.js","mtime":1573113339832},{"path":"F:\\work\\lhds\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\work\\lhds\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\work\\lhds\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.split\";\n// import Vue from 'vue'\n// \n// \n// import axios from 'axios'\n// \n// Vue.prototype.$http = axios\n\n/*\r\n* axios配置管理\r\n*/\nimport Vue from 'vue';\nimport axios from 'axios';\nimport router from \"../router\";\n\nvar qs = require('qs'); //axios自带qs插件\n\n\nimport { transCode } from \"../plugins/code.js\";\nimport vuex from \"../store/state.js\";\nvar vm = new Vue(); //--------------------------------------------全局设置-------------------------------\n// axios.defaults.baseURL = 'http://192.168.2.105:8080'; //配置接口基础地址\n// axios.defaults.baseURL = 'http://m252t77964.wicp.vip:20211';\n\naxios.defaults.baseURL = 'http://web.lhds.vip'; //配置接口基础地址\n\naxios.defaults.timeout = 50000; //响应超时时间\n\naxios.defaults.headers.post['Content-Type'] = 'application/json;charset=utf-8'; // axios.defaults.withCredentials = true; //允许携带cookie,实现跨域登录\t\n//-----------------在发送数据之前进行数据转换 , get不会转换,因为get走的是 parmas属性----------------------\n\naxios.defaults.transformRequest = function (_data) {\n  //第一个参数_data是接收过来的数据\n  // if(typeof(_data) == 'object'){\n  // \t\tlet formData = new FormData(); //使用formData方式发送表单 否则程序接收不到表单变量（formData可以实现文件的异步上传）\n  // \t\n  // \t\tfor(let item in _data) { //for in 遍历数据进行转换\n  // \t\n  // \t\t\tformData.append(item, _data[item]);\n  // \t\n  // \t\t}\t\t\t\n  // \t\tconsole.log('-->发送了数据:', _data);\n  // \t\n  // \t\treturn formData;\n  // }else{\n  // \treturn _data;\n  // }\n  var data = JSON.stringify(_data);\n  console.log('-->发送了数据:', data);\n  return data;\n};\n\nvar pending = []; //声明一个数组用于存储每个请求的取消函数和axios标识\n\nvar cancelToken = axios.CancelToken;\nvar Cancel;\n\nvar removePending = function removePending(url) {\n  for (var i in pending) {\n    if (pending[i].url == axios.defaults.baseURL + url) {\n      //在当前请求在数组中存在时执行取消函数\n      pending[i].f.cancel(); //执行取消操作\n    }\n  }\n};\n\nvar delPending = function delPending(url) {\n  for (var i in pending) {\n    if (pending[i].url == axios.defaults.baseURL + url) {\n      //在当前请求在数组中存在时删除\n      pending.splice(i, 1);\n    }\n  }\n}; //--------------------添加一个请求拦截器,每次请求都会拦截一次,但是尽量使用全局设置,方便每次使用不同的设置--------------\n\n\naxios.interceptors.request.use(function (_config) {\n  //在请求发出之前对配置进行一些操作\n  var config = _config;\n  removePending(config.url); // 阻止重复请求。当上个请求未完成时，相同的请求不会进行\n\n  config.cancelToken = new cancelToken(function (c) {\n    pending.push({\n      url: axios.defaults.baseURL + config.url,\n      f: c\n    });\n  });\n\n  if (config.hasToken) {\n    //是否携带token\n    if (sessionStorage.token) {\n      //session如果有token\n      config.headers = Object.assign(config.headers, {\n        'token': sessionStorage.token\n      });\n    }\n  } //如果想每次请求的时候更改配置, 在这里增加config配置项\n  // config.headers.token = 'RtakHgn04eKSsFCr1+RvaN+miAV/vYtG7nwtQhJJpem8eNlFRsTrnNpPXbxRLNhrXJholRU+GQd+177S0DRWhVtnPR4SanNfP1XPV9yuoX9VLLCTnunB+am1bA/UL8DB';\n\n\n  console.log('-->请求了URL(' + _config.method + '):', _config.baseURL + _config.url);\n  return config;\n}, function (_err) {\n  console.log('请求拦截器报错');\n}); //------------------------添加一个响应拦截器----------------------\n\naxios.interceptors.response.use(function (_res) {\n  //在这里对返回的数据进行处理\n  setTimeout(function () {\n    var ss = _res.config.url.split(axios.defaults.baseURL);\n\n    delPending(ss[ss.length - 1]);\n  }, 2000);\n  console.log('<--返回了数据', _res);\n\n  if (_res.data.code !== 1) {\n    //请求不成功，报错\n    if (_res.data.code == 20001) {\n      //用户未登录\n      sessionStorage.clear();\n      vuex.showBar = false;\n      router.push({\n        path: '/login'\n      });\n    } else {\n      var msg = transCode(_res.data.code);\n      vuex.errorText.text = msg;\n      vuex.snackbar = true;\n    }\n  }\n\n  return _res.data;\n}, function (_err) {\n  //处理错误\n  // let urls = _err.message.split(' ')[0];\n  var urls = _err.config.url.split(axios.defaults.baseURL);\n\n  setTimeout(function () {\n    delPending(urls[urls.length - 1]);\n  }, 2000);\n  console.log('>>>>>>发生了ajax错误');\n  console.log('-------------------------------------------');\n\n  if (_err.response) {\n    //请求已经发出，但是服务器响应返回的状态码不在2xx的范围内\t\t\n    console.log('status:', _err.response.status);\n    console.log('statusText:', _err.response.statusText);\n  } else {\n    //一些错误是在设置请求的时候触发\t\t   \n    console.log('设置的时候触发了错误');\n  }\n\n  console.log('url:', _err.config.url);\n  console.log('method:', _err.config.method);\n  console.log('data:', _err.config.data);\n  console.log('headers:', _err.config.headers);\n  console.log('-------------------------------------------');\n  return _err;\n}); //get请求\n\nexport var getTestData = function getTestData() {\n  var url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var fn = arguments.length > 2 ? arguments[2] : undefined;\n  var config = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  var errorCallBack = arguments.length > 4 ? arguments[4] : undefined;\n  axios.get(url, data, config).then(function (response) {\n    fn && fn(response);\n  }).catch(function (error) {\n    vuex.showOverLay = false;\n    errorCallBack && errorCallBack(error);\n    console.log('!!!getTestData发生了错误!!!：' + error);\n  });\n};\n/**\r\n * 异步函数获取axios中的数据\r\n */\n\nexport var getAsyncAjaxData = function getAsyncAjaxData() {\n  var url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var errorCallBack = arguments.length > 2 ? arguments[2] : undefined;\n  return new Promise(function (resolve) {\n    axios.post(url, data).then(function (response) {\n      resolve(response);\n    }).catch(function (error) {\n      errorCallBack && errorCallBack(error);\n      console.log('!!!async发生了错误!!!：' + error);\n    });\n  });\n};\n/**\r\n * axios发起单个请求\r\n * \r\n * @param {STRING} url 请求数据的路径\r\n * @param {JSON} data 需要发送的数据\r\n * @param {Function} fn 数据响应后的回调函数\r\n * @param {Object} config 修改默认配置\r\n */\n\nexport var getAjaxData = function getAjaxData() {\n  var url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var fn = arguments.length > 2 ? arguments[2] : undefined;\n  var config = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  var errorCallBack = arguments.length > 4 ? arguments[4] : undefined;\n  axios.post(url, data, config).then(function (response) {\n    fn && fn(response);\n  }).catch(function (error) {\n    vuex.showOverLay = false;\n    errorCallBack && errorCallBack(error);\n    console.log('!!!single发生了错误!!!：' + error);\n  });\n};\n/**\r\n * axios同时发起多个请求\r\n * \r\n * @param {Array} paramArr 多个请求参数的数组\r\n * @param {Function(返回的数据1,返回的数据2...)} fn 数据响应后的回调函数\r\n */\n\nexport var getAllAjaxData = function getAllAjaxData() {\n  var paramArr = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var fn = arguments.length > 1 ? arguments[1] : undefined;\n  var newArr = [];\n  paramArr.forEach(function (item) {\n    newArr.push(axios.post(item.url || '', item.data || {}));\n  });\n  axios.all(newArr).then(axios.spread(fn)).catch(function (error) {\n    return console.log('发生了错误：' + error);\n  });\n};\n/**\r\n * axios同时发起多个请求 跟上述不同的地方在于 这里的回调不拆开 直接返回一组回调\r\n * 在响应中判断$ax.getSimult(arr, (resArr) =>{\r\n\t\t\t\tlet length = resArr.length;\r\n\t\t\t\tlet len = 0;\r\n\t\t\t\tlet errArr = [];\r\n\t\t\t\tresArr.forEach((res,i) =>{\r\n\t\t\t\t\tif(res.code == 0){\r\n\t\t\t\t\t\tlen++;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\terrArr.push(res.msg);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif(len == length){\r\n\t\t\t\t\tthis.$Message.success('修改成功！');\r\n * \r\n * @param {Array} paramArr 多个请求参数的数组\r\n * @param {Function(返回的数据1,返回的数据2...)} fn 数据响应后的回调函数\r\n */\n\nexport var getSimult = function getSimult() {\n  var paramArr = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var fn = arguments.length > 1 ? arguments[1] : undefined;\n  var newArr = [];\n  paramArr.forEach(function (item) {\n    newArr.push(axios.post(item.url || '', item.data || {}));\n  });\n  axios.all(newArr).then(fn).catch(function (error) {\n    return console.log('发生了错误：' + error);\n  });\n}; //使用qs插件序列化数据\n\nexport var QSStringify = function QSStringify() {\n  var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var str = '{' + qs.stringify(params, {\n    encoder: function encoder(str) {\n      if (typeof str === 'string' && typeof str !== 'number') {\n        return '\"' + str + '\"';\n      } else {\n        return str;\n      }\n    }\n  }) + '}';\n  var jsonStr = str.replace(/\\=/g, ':').replace(/\\&/g, ',');\n  var jsonData = JSON.parse(jsonStr);\n  return jsonData;\n}; //使用qs插件的Ajax提交数据\n\nexport var getAjaxQsStringify = function getAjaxQsStringify() {\n  var url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var fn = arguments.length > 2 ? arguments[2] : undefined;\n  var config = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  var errorCallBack = arguments.length > 4 ? arguments[4] : undefined;\n  axios.post(url, QSStringify(data), config).then(function (response) {\n    fn && fn(response);\n  }).catch(function (error) {\n    errorCallBack && errorCallBack(error);\n    console.log('!!!发生了错误!!!：' + error);\n  });\n};",{"version":3,"sources":["F:\\work\\lhds\\src\\axios\\index.js"],"names":["Vue","axios","router","qs","require","transCode","vuex","vm","defaults","baseURL","timeout","headers","post","transformRequest","_data","data","JSON","stringify","console","log","pending","cancelToken","CancelToken","Cancel","removePending","url","i","f","cancel","delPending","splice","interceptors","request","use","_config","config","c","push","hasToken","sessionStorage","token","Object","assign","method","_err","response","_res","setTimeout","ss","split","length","code","clear","showBar","path","msg","errorText","text","snackbar","urls","status","statusText","getTestData","fn","errorCallBack","get","then","catch","error","showOverLay","getAsyncAjaxData","Promise","resolve","getAjaxData","getAllAjaxData","paramArr","newArr","forEach","item","all","spread","getSimult","QSStringify","params","str","encoder","jsonStr","replace","jsonData","parse","getAjaxQsStringify"],"mappings":"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","sourcesContent":["// import Vue from 'vue'\r\n// \r\n// \r\n// import axios from 'axios'\r\n// \r\n// Vue.prototype.$http = axios\r\n /*\r\n * axios配置管理\r\n */\r\n\r\nimport Vue from 'vue'\r\nimport axios from 'axios';\r\nimport router from '../router'\r\nconst qs = require('qs');//axios自带qs插件\r\nimport {transCode} from '../plugins/code.js'\r\nimport vuex from '../store/state.js'\r\nconst vm = new Vue();\r\n\r\n//--------------------------------------------全局设置-------------------------------\r\n\r\n// axios.defaults.baseURL = 'http://192.168.2.105:8080'; //配置接口基础地址\r\n// axios.defaults.baseURL = 'http://m252t77964.wicp.vip:20211';\r\naxios.defaults.baseURL = 'http://web.lhds.vip'; //配置接口基础地址\r\naxios.defaults.timeout = 50000; //响应超时时间\r\n\r\naxios.defaults.headers.post['Content-Type'] = 'application/json;charset=utf-8';\r\n\r\n\r\n// axios.defaults.withCredentials = true; //允许携带cookie,实现跨域登录\t\r\n\r\n//-----------------在发送数据之前进行数据转换 , get不会转换,因为get走的是 parmas属性----------------------\r\n\r\naxios.defaults.transformRequest = (_data) => { //第一个参数_data是接收过来的数据\r\n\t// if(typeof(_data) == 'object'){\r\n\t// \t\tlet formData = new FormData(); //使用formData方式发送表单 否则程序接收不到表单变量（formData可以实现文件的异步上传）\r\n\t// \t\r\n\t// \t\tfor(let item in _data) { //for in 遍历数据进行转换\r\n\t// \t\r\n\t// \t\t\tformData.append(item, _data[item]);\r\n\t// \t\r\n\t// \t\t}\t\t\t\r\n\t// \t\tconsole.log('-->发送了数据:', _data);\r\n\t// \t\r\n\t// \t\treturn formData;\r\n\t// }else{\r\n\t// \treturn _data;\r\n\t// }\r\n\t\r\n\t\tlet data = JSON.stringify(_data);\r\n\t\tconsole.log('-->发送了数据:', data);\r\n\t\treturn data;\r\n\t\r\n};\r\n\r\n\r\n　\tlet pending = []; //声明一个数组用于存储每个请求的取消函数和axios标识\r\n\tlet cancelToken = axios.CancelToken;\r\n\t \r\n\tlet Cancel;\r\n\t\r\n\tlet removePending = (url) => {\r\n\r\n\t\tfor(let i in pending){\r\n\t\t\tif(pending[i].url == axios.defaults.baseURL+url) { //在当前请求在数组中存在时执行取消函数\r\n\t\t\t\tpending[i].f.cancel(); //执行取消操作\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\t\t\r\n\tlet delPending = (url) => {\r\n\t\tfor(let i in pending){\r\n\t\t\tif(pending[i].url == axios.defaults.baseURL+url) { //在当前请求在数组中存在时删除\r\n\t\t\t\tpending.splice(i, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\r\n//--------------------添加一个请求拦截器,每次请求都会拦截一次,但是尽量使用全局设置,方便每次使用不同的设置--------------\r\n\r\naxios.interceptors.request.use(\r\n\t\r\n\t_config => { //在请求发出之前对配置进行一些操作\r\n\r\n\t\tlet config = _config;\r\n\t\t  removePending(config.url);\r\n\t\t    // 阻止重复请求。当上个请求未完成时，相同的请求不会进行\r\n\t\t\t\r\n\t\t\tconfig.cancelToken = new cancelToken((c) => {\r\n\t\t\t\tpending.push({\r\n\t\t\t\t    url: axios.defaults.baseURL+config.url,\r\n\t\t\t\t    f:c\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\tif(config.hasToken){ //是否携带token\r\n\t\t\tif(sessionStorage.token){//session如果有token\r\n\t\t\t\tconfig.headers = Object.assign(config.headers,{'token':sessionStorage.token});\r\n\t\t\t}\r\n\t\t}\r\n\t\t//如果想每次请求的时候更改配置, 在这里增加config配置项\r\n\t\t// config.headers.token = 'RtakHgn04eKSsFCr1+RvaN+miAV/vYtG7nwtQhJJpem8eNlFRsTrnNpPXbxRLNhrXJholRU+GQd+177S0DRWhVtnPR4SanNfP1XPV9yuoX9VLLCTnunB+am1bA/UL8DB';\r\n\t\t\r\n\t\t\r\n\t\tconsole.log('-->请求了URL(' + _config.method + '):', _config.baseURL + _config.url);\r\n\t\r\n\t\treturn config;\r\n\r\n\t},\r\n\t\r\n\t_err => {\r\n\t\tconsole.log('请求拦截器报错');\r\n\t}\r\n\t\r\n);\r\n\r\n//------------------------添加一个响应拦截器----------------------\r\n\t\t\t\r\naxios.interceptors.response.use(\r\n\r\n\t_res => { //在这里对返回的数据进行处理\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tlet ss = _res.config.url.split(axios.defaults.baseURL);\r\n\t\t\t\r\n\t\t\tdelPending(ss[ss.length-1]);\r\n\t\t\t\r\n\t\t}, 2000);\r\n\r\n\t\t\t\r\n\t\tconsole.log('<--返回了数据', _res);\r\n\t\t\r\n\t\tif(_res.data.code!==1){//请求不成功，报错\r\n\t\t\tif(_res.data.code ==20001){ //用户未登录\r\n\t\t\t\tsessionStorage.clear();\r\n\t\t\t\tvuex.showBar = false;\r\n\t\t\t\trouter.push({path:'/login'});\r\n\t\t\t}else{\r\n\t\t\t\tlet msg = transCode(_res.data.code);\r\n\t\t\t\tvuex.errorText.text = msg; \r\n\t\t\t\tvuex.snackbar = true;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn _res.data;\r\n\r\n\t},\r\n\t_err => { //处理错误\r\n\t    // let urls = _err.message.split(' ')[0];\r\n\t\t\r\n\t\tlet urls =_err.config.url.split(axios.defaults.baseURL);\r\n\t\t\r\n\t\tsetTimeout(() => {\r\n\t\t\t\t  \r\n\t\t\tdelPending(urls[urls.length-1])\r\n\t\t\t\r\n\t\t}, 2000);\r\n\r\n\t\t\r\n\t\tconsole.log('>>>>>>发生了ajax错误');\r\n\r\n\t\tconsole.log('-------------------------------------------');\r\n\r\n\t\tif(_err.response) { //请求已经发出，但是服务器响应返回的状态码不在2xx的范围内\t\t\r\n\t\t\tconsole.log('status:', _err.response.status);\r\n\r\n\t\t\tconsole.log('statusText:', _err.response.statusText);\r\n\r\n\t\t} else { //一些错误是在设置请求的时候触发\t\t   \r\n\t\t\tconsole.log('设置的时候触发了错误');\r\n\t\t}\r\n\r\n\t\tconsole.log('url:', _err.config.url);\r\n\r\n\t\tconsole.log('method:', _err.config.method);\r\n\r\n\t\tconsole.log('data:', _err.config.data);\r\n\r\n\t\tconsole.log('headers:', _err.config.headers);\r\n\r\n\t\tconsole.log('-------------------------------------------');\r\n\r\n\t\treturn _err;\r\n\t}\r\n);\r\n\r\n//get请求\r\nexport const getTestData = (url = '', data = {}, fn, config = {}, errorCallBack) => {\r\n\taxios.get(url, data, config).then(response => {\r\n\t\tfn && fn(response);\r\n\t}).catch(error => {\r\n\t\tvuex.showOverLay = false;\r\n\t\terrorCallBack && errorCallBack(error);\r\n\t\tconsole.log('!!!getTestData发生了错误!!!：' + error);\r\n\t});\r\n}\r\n\r\n/**\r\n * 异步函数获取axios中的数据\r\n */\r\nexport const getAsyncAjaxData = (url = '', data = {}, errorCallBack) => {\r\n\treturn new Promise(resolve => {\r\n\t\taxios.post(url, data).then(response => {\r\n\t\t\tresolve(response);\r\n\t\t}).catch(error => {\r\n\t\t\terrorCallBack && errorCallBack(error);\r\n\t\t\tconsole.log('!!!async发生了错误!!!：' + error);\r\n\t\t});\r\n\t});\r\n}\r\n\r\n/**\r\n * axios发起单个请求\r\n * \r\n * @param {STRING} url 请求数据的路径\r\n * @param {JSON} data 需要发送的数据\r\n * @param {Function} fn 数据响应后的回调函数\r\n * @param {Object} config 修改默认配置\r\n */\r\nexport const getAjaxData = (url = '', data = {}, fn, config = {}, errorCallBack) => {\r\n\taxios.post(url, data, config).then(response => {\r\n\t\tfn && fn(response);\r\n\t}).catch(error => {\r\n\t\tvuex.showOverLay = false;\r\n\t\terrorCallBack && errorCallBack(error);\r\n\t\tconsole.log('!!!single发生了错误!!!：' + error);\r\n\t});\r\n}\r\n\r\n/**\r\n * axios同时发起多个请求\r\n * \r\n * @param {Array} paramArr 多个请求参数的数组\r\n * @param {Function(返回的数据1,返回的数据2...)} fn 数据响应后的回调函数\r\n */\r\nexport const getAllAjaxData = (paramArr = [], fn) => {\r\n\tlet newArr = [];\r\n\tparamArr.forEach(item => {\r\n\t\tnewArr.push(axios.post(item.url || '',item.data || {}));\r\n\t});\r\n\taxios.all(newArr).then(axios.spread(fn)).catch(error => console.log('发生了错误：'+error));\r\n}\r\n/**\r\n * axios同时发起多个请求 跟上述不同的地方在于 这里的回调不拆开 直接返回一组回调\r\n * 在响应中判断$ax.getSimult(arr, (resArr) =>{\r\n\t\t\t\tlet length = resArr.length;\r\n\t\t\t\tlet len = 0;\r\n\t\t\t\tlet errArr = [];\r\n\t\t\t\tresArr.forEach((res,i) =>{\r\n\t\t\t\t\tif(res.code == 0){\r\n\t\t\t\t\t\tlen++;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\terrArr.push(res.msg);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif(len == length){\r\n\t\t\t\t\tthis.$Message.success('修改成功！');\r\n * \r\n * @param {Array} paramArr 多个请求参数的数组\r\n * @param {Function(返回的数据1,返回的数据2...)} fn 数据响应后的回调函数\r\n */\r\nexport const getSimult = (paramArr = [], fn) => {\r\n\tlet newArr = [];\r\n\tparamArr.forEach(item => {\r\n\t\tnewArr.push(axios.post(item.url || '',item.data || {}));\r\n\t});\r\n\taxios.all(newArr).then(fn).catch(error => console.log('发生了错误：'+error));\r\n}\r\n//使用qs插件序列化数据\r\nexport const QSStringify = (params={}) => {\r\n\tlet str = '{'+qs.stringify(params, {encoder: function(str){\r\n\t\tif(typeof(str) === 'string' && typeof(str) !== 'number'){\r\n\t\t\treturn '\"'+ str +'\"'\r\n\t\t}else{\r\n\t\t\treturn str\r\n\t\t}\r\n\t}})+'}';\r\n\tlet jsonStr = str.replace(/\\=/g, ':').replace(/\\&/g, ',');\r\n  \tlet jsonData = JSON.parse(jsonStr);\r\n  \treturn jsonData;\r\n}\r\n\r\n//使用qs插件的Ajax提交数据\r\nexport const getAjaxQsStringify = (url = '', data = {}, fn, config = {}, errorCallBack) => {\r\n\taxios.post(url, QSStringify(data), config).then(response => {\r\n\t\tfn && fn(response);\r\n\t}).catch(error => {\r\n\t\terrorCallBack && errorCallBack(error);\r\n\t\tconsole.log('!!!发生了错误!!!：' + error);\r\n\t});\r\n}"]}]}