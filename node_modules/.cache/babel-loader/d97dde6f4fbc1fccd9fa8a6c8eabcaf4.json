{"remainingRequest":"F:\\work\\vuefityDemo\\node_modules\\babel-loader\\lib\\index.js!F:\\work\\vuefityDemo\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\work\\vuefityDemo\\src\\plugins\\socket.js","dependencies":[{"path":"F:\\work\\vuefityDemo\\src\\plugins\\socket.js","mtime":1571646606897},{"path":"F:\\work\\vuefityDemo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\work\\vuefityDemo\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\work\\vuefityDemo\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["var websock = null;\nvar state = -1;\nimport vuex from \"../store/index\";\nexport default {\n  initWebSocket: function initWebSocket() {\n    var _this = this;\n\n    //初始化weosocket\n    var token = sessionStorage.token;\n\n    if (token) {\n      var ds = window.encodeURIComponent(token);\n      var wsuri = \"ws://192.168.2.103:8080/EasRobotWS/ws?token=\".concat(ds); // const wsuri = `ws://ws.lhds.vip:8080/EasRobotWS/ws?token=${ds}`;\n      // const wsuri = `ws://m252t77964.wicp.vip:20211/EasRobotWS/ws?token=${ds}`\n\n      websock = new WebSocket(wsuri);\n      state = websock.readyState;\n\n      websock.onmessage = function (e) {\n        _this.websocketonmessage(e);\n      };\n\n      websock.onopen = function () {\n        _this.websocketonopen();\n      };\n\n      websock.onerror = function () {\n        console.log('失败了');\n      };\n\n      websock.onclose = function (e) {\n        _this.websocketclose(e);\n      };\n    }\n  },\n  websocketonmessage: function websocketonmessage(e) {\n    var result = JSON.parse(e.data);\n    console.log('收到数据 = >', result);\n    state = websock.readyState;\n    vuex.state.collocationList = result;\n  },\n  websocketonopen: function websocketonopen() {\n    console.log('打开websocket'); //this.websocketsend();\n\n    state = websock.readyState;\n  },\n  websocketclose: function websocketclose(e) {\n    //关闭\n    console.log('断开连接', e);\n    vuex.state.collocationList = [];\n    state = -1;\n  },\n  websocketsend: function websocketsend(Data) {\n    //数据发送\n    console.log('发送数据 = >', Data);\n    websock.send(Data);\n  },\n  close: function close() {\n    if (state >= 0) {\n      websock.close();\n      state = websock.readyState; // state = -1;\n      // console.log(state)\n    }\n  },\n  lookState: function lookState() {\n    //查询sock当前状态\n    return state;\n  }\n};",{"version":3,"sources":["F:\\work\\vuefityDemo\\src\\plugins\\socket.js"],"names":["websock","state","vuex","initWebSocket","token","sessionStorage","ds","window","encodeURIComponent","wsuri","WebSocket","readyState","onmessage","e","websocketonmessage","onopen","websocketonopen","onerror","console","log","onclose","websocketclose","result","JSON","parse","data","collocationList","websocketsend","Data","send","close","lookState"],"mappings":"AAAC,IAAIA,OAAO,GAAG,IAAd;AAEA,IAAIC,KAAK,GAAG,CAAC,CAAb;AAEA,OAAOC,IAAP;AAEA,eAAc;AAEbC,EAAAA,aAFa,2BAEE;AAAA;;AAAE;AAChB,QAAIC,KAAK,GAAGC,cAAc,CAACD,KAA3B;;AAEA,QAAGA,KAAH,EAAS;AACR,UAAIE,EAAE,GAAGC,MAAM,CAACC,kBAAP,CAA0BJ,KAA1B,CAAT;AAEA,UAAMK,KAAK,yDAAkDH,EAAlD,CAAX,CAHQ,CAIR;AAEA;;AAEAN,MAAAA,OAAO,GAAG,IAAIU,SAAJ,CAAcD,KAAd,CAAV;AAEAR,MAAAA,KAAK,GAAGD,OAAO,CAACW,UAAhB;;AAEAX,MAAAA,OAAO,CAACY,SAAR,GAAoB,UAACC,CAAD,EAAM;AACzB,QAAA,KAAI,CAACC,kBAAL,CAAwBD,CAAxB;AACA,OAFD;;AAGAb,MAAAA,OAAO,CAACe,MAAR,GAAiB,YAAK;AACrB,QAAA,KAAI,CAACC,eAAL;AACA,OAFD;;AAGAhB,MAAAA,OAAO,CAACiB,OAAR,GAAkB,YAAU;AAC3BC,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ;AACA,OAFD;;AAGAnB,MAAAA,OAAO,CAACoB,OAAR,GAAkB,UAACP,CAAD,EAAM;AACvB,QAAA,KAAI,CAACQ,cAAL,CAAoBR,CAApB;AACA,OAFD;AAGA;AACD,GA9BY;AAgCbC,EAAAA,kBAhCa,8BAgCMD,CAhCN,EAgCQ;AACpB,QAAIS,MAAM,GAAGC,IAAI,CAACC,KAAL,CAAWX,CAAC,CAACY,IAAb,CAAb;AAEAP,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAuBG,MAAvB;AAEArB,IAAAA,KAAK,GAAGD,OAAO,CAACW,UAAhB;AAEAT,IAAAA,IAAI,CAACD,KAAL,CAAWyB,eAAX,GAA6BJ,MAA7B;AAEA,GAzCY;AA2CbN,EAAAA,eA3Ca,6BA2CI;AAChBE,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EADgB,CAGhB;;AAEAlB,IAAAA,KAAK,GAAGD,OAAO,CAACW,UAAhB;AAEA,GAlDY;AAoDbU,EAAAA,cApDa,0BAoDER,CApDF,EAoDI;AAAG;AACnBK,IAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBN,CAApB;AAEAX,IAAAA,IAAI,CAACD,KAAL,CAAWyB,eAAX,GAA6B,EAA7B;AAEAzB,IAAAA,KAAK,GAAG,CAAC,CAAT;AACA,GA1DY;AA4Db0B,EAAAA,aA5Da,yBA4DCC,IA5DD,EA4DM;AAAC;AACnBV,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAuBS,IAAvB;AACA5B,IAAAA,OAAO,CAAC6B,IAAR,CAAaD,IAAb;AACA,GA/DY;AAiEbE,EAAAA,KAjEa,mBAiEN;AACN,QAAG7B,KAAK,IAAI,CAAZ,EAAc;AACbD,MAAAA,OAAO,CAAC8B,KAAR;AACA7B,MAAAA,KAAK,GAAGD,OAAO,CAACW,UAAhB,CAFa,CAGb;AACA;AACA;AAED,GAzEY;AA0EboB,EAAAA,SA1Ea,uBA0EF;AAAC;AACX,WAAO9B,KAAP;AACA;AA5EY,CAAd","sourcesContent":["\tvar websock = null;\n\n\tvar state = -1;\n\n\timport vuex from '../store/index'\n\n\texport default{\n\t\t\n\t\tinitWebSocket(){ //初始化weosocket\n\t\t\tlet token = sessionStorage.token;\n\t\t\t\n\t\t\tif(token){\n\t\t\t\tlet ds = window.encodeURIComponent(token);\n\t\t\t\t\r\n\t\t\t\tconst wsuri = `ws://192.168.2.103:8080/EasRobotWS/ws?token=${ds}`;\n\t\t\t\t// const wsuri = `ws://ws.lhds.vip:8080/EasRobotWS/ws?token=${ds}`;\n\t\t\t\t\n\t\t\t\t// const wsuri = `ws://m252t77964.wicp.vip:20211/EasRobotWS/ws?token=${ds}`\n\t\t\t\t\n\t\t\t\twebsock = new WebSocket(wsuri);\n\t\t\t\t\n\t\t\t\tstate = websock.readyState;\n\t\t\t\t\n\t\t\t\twebsock.onmessage = (e) =>{\n\t\t\t\t\tthis.websocketonmessage(e);\n\t\t\t\t};\n\t\t\t\twebsock.onopen = () =>{\n\t\t\t\t\tthis.websocketonopen();\n\t\t\t\t};\n\t\t\t\twebsock.onerror = function(){\n\t\t\t\t\tconsole.log('失败了');\n\t\t\t\t};\n\t\t\t\twebsock.onclose = (e) =>{\n\t\t\t\t\tthis.websocketclose(e);\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t\t\t\n\t\twebsocketonmessage(e){\n\t\t\tlet result = JSON.parse(e.data);\n\t\t\t\n\t\t\tconsole.log('收到数据 = >',result);\n\t\t\t\n\t\t\tstate = websock.readyState;\n\t\t\t\n\t\t\tvuex.state.collocationList = result;\n\n\t\t},\n\t\t\n\t\twebsocketonopen(){\n\t\t\tconsole.log('打开websocket');\n\n\t\t\t//this.websocketsend();\n\t\t\t\n\t\t\tstate = websock.readyState;\n\n\t\t},\n\t\t\n\t\twebsocketclose(e){  //关闭\n\t\t\tconsole.log('断开连接', e);\n\t\t\t\n\t\t\tvuex.state.collocationList = [];\n\t\t\t\n\t\t\tstate = -1;\n\t\t},\n\n\t\twebsocketsend(Data){//数据发送\n\t\t\tconsole.log('发送数据 = >',Data);\n\t\t\twebsock.send(Data);\n\t\t},\n\t\t\n\t\tclose(){\n\t\t\tif(state >= 0){\n\t\t\t\twebsock.close();\n\t\t\t\tstate = websock.readyState;\n\t\t\t\t// state = -1;\n\t\t\t\t// console.log(state)\n\t\t\t}\n\t\t\t\n\t\t},\n\t\tlookState(){//查询sock当前状态\n\t\t\treturn state;\n\t\t}\n\n\n\t\t\n\t}\t\t\n\t\t\t\t\n\n\t\t\t\t\n\t\t\t\t\n"]}]}