{"remainingRequest":"C:\\Users\\pxy\\Downloads\\test\\lhds\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\pxy\\Downloads\\test\\lhds\\src\\components\\common\\Ubox.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\pxy\\Downloads\\test\\lhds\\src\\components\\common\\Ubox.vue","mtime":1574651315627},{"path":"C:\\Users\\pxy\\Downloads\\test\\lhds\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1572955172692},{"path":"C:\\Users\\pxy\\Downloads\\test\\lhds\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1572955235189},{"path":"C:\\Users\\pxy\\Downloads\\test\\lhds\\node_modules\\babel-loader\\lib\\index.js","mtime":1572955171173},{"path":"C:\\Users\\pxy\\Downloads\\test\\lhds\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1572955172692},{"path":"C:\\Users\\pxy\\Downloads\\test\\lhds\\node_modules\\vue-loader\\lib\\index.js","mtime":1572955240129}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Utils from '@/plugins/cryAes.js'\nimport {\n\tmapActions\n} from 'vuex';\nimport upSvg from '@/img/up.svg'\nimport { scrollMixins } from '@/mixins/scroll.js'\nexport default {\n\tmixins:[scrollMixins],\n\tdata: () => ({\n\t\ttransition: 'scale-transition',\n\t\t\n\t\tloading:true,//控制骨架屏 true表示显示\n\t\t\n\t\tupIcon:upSvg,\n\t\t\n\t\ttarget: '#vRow',\n\t\t\n\t\toptions: {\n\t\t\tduration: 1000,\n\t\t\toffset: 0,\n\t\t\teasing: 'easeInOutCubic'\n\t\t},\n\t\t\n\t\tcurPage: {\n\t\t\tpage: 1,\n\t\t\tsize: 0\n\t\t},\n\t\t\n\t\tvalid:true,\n\n\t\tnews:{\n\t\t\tA1:'',\n\t\t\tA2:'',\n\t\t\tA3:'',\n\t\t\tA4:0.1,\n\t\t\tA5:0\n\t\t},\n\t\t\n\t\tnewsPassword:'',//交易所为OKex时特定字段\n\t\t\n\t\tplace:'',//当前选中的交易所\n\t\t\n\t\titems:[],//交易所对应的买入/卖出费率数据\n\t\t\n\t\taddDialog:false,\n\t\tapiColumns:[\n\t\t\t  {\n\t\t\t\ttext: '名称',\n\t\t\t\talign: 'center',\n\t\t\t\tsortable: false,\n\t\t\t\tvalue: 'exchange',\n\t\t\t  },\n\t\t\t  {\n\t\t\t\ttext: '备注',\n\t\t\t\talign: 'center',\n\t\t\t\tsortable: false,\n\t\t\t\tvalue: 'remark',\n\t\t\t  },\n\t\t\t  {\n\t\t\t\ttext: 'API KEY',\n\t\t\t\talign: 'center',\n\t\t\t\tsortable: false,\n\t\t\t\tvalue: 'key',\n\t\t\t  },\n\t\t\t  {\n\t\t\t\ttext: 'API SECRET',\n\t\t\t\talign: 'center',\n\t\t\t\tsortable: false,\n\t\t\t\tvalue: 'secret',\n\t\t\t  },\n\t\t\t  {\n\t\t\t\ttext: '买入费率(%)',\n\t\t\t\talign: 'center',\n\t\t\t\tsortable: false,\n\t\t\t\tvalue: 'buy',\n\t\t\t  },\n\t\t\t  {\n\t\t\t\ttext: '卖出费率(%)',\n\t\t\t\talign: 'center',\n\t\t\t\tsortable: false,\n\t\t\t\tvalue: 'sell',\n\t\t\t  },\n\t\t\t  {\n\t\t\t\ttext: '操作',\n\t\t\t\talign:'center',\n\t\t\t\tsortable: false,\n\t\t\t\tvalue: 'del'\n\t\t\t  }\n\t\t],\n\t\tapiList:[],\n\n\t\trules: {\n\t\t\trequired: v => !!v || '必填',\n\t\t\tlength: v =>  (v&&v.length <= 68) || '超出长度',\n\t\t\tsize: v => v > 0 || '必须大于0',\n\t\t\tisEmpty: v => /\\S/.test(v) || '不可为空',\n\t\t\tnot: v => !/[\\u4E00-\\u9FA5]/g.test(v) || '不能是中文'\n\t\t},\n\t}),\n\twatch:{\n\t\t\n\t\tplace:{\n\t\t\thandler(newV,oldV){\n\t\t\t\tthis.items.forEach(item =>{\n\t\t\t\t\tif(item.exc == newV){\n\t\t\t\t\t\tthis.news.A4 = item.buy;\n\t\t\t\t\t\tthis.news.A5 = item.sell;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\timmediate:true\n\t\t},\n\t\t\n\t\twssData:{\n\t\t\thandler(nV,oV){\n\t\t\t\tthis.getMessage();\n\t\t\t},\n\t\t\tdeep:true\n\t\t},\n\t\taddDialog:{\n\t\t\thandler(nV,oV){\n\t\t\t\tnV&&this.afterOpen();//mixins不允许滚动\n\t\t\t\t!nV&&this.beforeClose();\n\t\t\t},\n\t\t\timmediate:true\n\t\t}\n\t\t\n\t},\n\t\n\tcomputed:{\n\t\twssData(){//wss传递的消息\n\t\t\treturn this.$store.state.collocationList;\n\t\t}\n\t},\n\tmounted() {\n\t\tif(sessionStorage.apiPublic){\n\t\t\tthis.items = JSON.parse(sessionStorage.apiPublic);\n\t\t\tthis.place = this.items.length>0?this.items[0].exc:'';\n\t\t}else{\n\t\t\t$ax.getTestData('/EasWebUser/getAPIData',{},(res)=> {\n\t\t\t\tif(res.code == 1){\t\t\t\t\n\t\t\t\t\tsessionStorage.apiPublic = JSON.stringify(res.data);\n\t\t\t\t\tthis.items = res.data;\n\t\t\t\t\tthis.place = this.items.length>0?this.items[0].exc:'';\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t\n\t\tthis.getApiList();\n\t},\n\t\n\tbeforeRouteLeave(to,from,next){//路由离开前断开\n\n\t\tthis.$sock.close();\n\t\t\n\t\tnext();//跳转路由\n\t\t\n\t},\n\t\n\tmethods: {\n\t\t\n\t\t...mapActions(['changeLay', 'changeSnack']),\n\t\t\n\t\ttransUpperCase(data){ //交易对转大写\n\t\t\treturn data.toUpperCase();\n\t\t},\n\t\t\n\t\tinputShow(number) { //点击野马\n\t\t\tthis.curPage.page = number;\n\t\t\tthis.$vuetify.goTo(this.target, this.options);//平滑滚动到表头\n\t\t\tthis.getApiList();\n\t\t},\n\n\t\tchangeTime(time) {\n\t\t\treturn this.$utils.timestampToTime(Number(time));\n\t\t},\n\n\t\tgetMessage(){//wss传递的消息\n\t\t\tlet result = this.wssData;\n\t\t\tswitch (result.code){\n\t\t\t\tcase 20013://客户端在线\n\t\t\t\tthis.sendMsgToClient();\n\t\t\t\t\tbreak;\t\n\t\t\t\t\t\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\t\n\t\t},\n\n\t\tdelApi(item){\n\t\t\tthis.$xyDialog({\n\t\t\t\ttitle:'删除API',\n\t\t\t    content: '确定删除吗? 该操作不可撤销',\n\t\t\t    onOk: () => {\n\t\t\t        this.changeLay(true);\n\t\t\t        \n\t\t\t        $ax.getAjaxData('/EasWebUser/delAPI', {\n\t\t\t        \tid: item.id\n\t\t\t        }, (res) => {\n\t\t\t        \tthis.changeLay(false);\n\t\t\t        \tif (res.code == 1) {\n\t\t\t        \t\tlet msg = {\n\t\t\t        \t\t\tstate: true,\n\t\t\t        \t\t\terrorText: {\n\t\t\t        \t\t\t\ttype: 'success',\n\t\t\t        \t\t\t\ttext: '删除成功'\n\t\t\t        \t\t\t}\n\t\t\t        \t\t}\n\t\t\t        \t\tthis.changeSnack(msg);\n\t\t\t        \t\t\n\t\t\t        \t\tlet state = this.$sock.lookState();\n\t\t\t        \t\t\n\t\t\t        \t\tstate==-1?this.$sock.initWebSocket():this.sendMsgToClient();\n\t\t\t        \t\t\n\t\t\t        \t\tlet index = this.apiList.indexOf(item);\n\t\t\t        \n\t\t\t        \t\tsessionStorage.removeItem('collocation');//删除api/rule的时候把存储的旧数据清空\n\t\t\t        \t\t\n\t\t\t        \t\tthis.apiList.splice(index, 1);\n\t\t\t        \t}\n\t\t\t        \n\t\t\t        }, {\n\t\t\t        \thasToken: true\n\t\t\t        });\n\t\t\t     }\n\t\t\t});\n\t\t\t\n\t\t},\n\n\t\tcloseAccount(){\n\t\t\tthis.$refs.form.resetValidation();\n\t\t\tthis.addDialog = false;\n\t\t\tthis.news = this.$options.data().news;\n\t\t\tthis.newsPassword = '';\n\t\t\tthis.place = this.items.length>0?this.items[0].exc:'';\n\t\t},\n\t\t\n\t\taddOneAccount(){//添加新账户\n\t\t\tif (this.$refs.form.validate()) {\n\t\t\t    let other = {\n\t\t\t    \tA0:this.place,\n\t\t\t    \tA6:this.newsPassword,\n\t\t\t    \tA7:0,\n\t\t\t    \tA8:0,\n\t\t\t    \tA9:0,\n\t\t\t    \tA10:0\n\t\t\t    };\n\t\t\t\t\n\t\t\t    let obj = {\n\t\t\t    \texc:this.place,\n\t\t\t    \tremark:this.news.A1,\n\t\t\t    \tdata:Utils.encrypt(JSON.stringify(Object.assign({},this.news,other)))\n\t\t\t    }\n\t\t\t\t\n\t\t\t\tthis.changeLay(true);//loading\n\t\t\t    $ax.getAjaxData('/EasWebUser/addAPI', obj, (res) => {\t\t\t\n\t\t\t    \tthis.changeLay(false);\n\t\t\t    \tif (res.code == 1) {\n\t\t\t    \t\tlet msg = {\n\t\t\t    \t\t\tstate:true,\n\t\t\t    \t\t\terrorText:{\n\t\t\t    \t\t\t\ttype:'success',\n\t\t\t    \t\t\t\ttext:'添加成功'\n\t\t\t    \t\t\t}\n\t\t\t    \t\t}\n\t\t\t    \t\tthis.changeSnack(msg);\n\t\t\t\t\t\t\n\t\t\t\t\t\tlet state = this.$sock.lookState();\n\t\t\t\t\t\t\n\t\t\t\t\t\tstate==-1?this.$sock.initWebSocket():this.sendMsgToClient();\n\t\t\t\t\t\t\n\t\t\t    \t\tthis.addDialog = false;\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.$refs.form.resetValidation();\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.news = this.$options.data().news;\n\t\t\t\t\t\t\n\t\t\t\t\t\tsessionStorage.removeItem('collocation');\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.getApiList();\n\t\t\t    \t}\n\t\t\t    \n\t\t\t    }, {\n\t\t\t    \thasToken: true\n\t\t\t    });\n\t\t\t}\n\t\t\t\n\t\t},\n\n\t\tsendMsgToClient(){\n\t\t\t\n\t\t\tthis.$sock.websocketsend(JSON.stringify({code:1006}));\n\t\t\t\n\t\t},\n\n\t\tgetApiList(){//获取api列表\n\t\t\tthis.loading = true;\n\t\t\t$ax.getAjaxData('/EasWebUser/getAPI', {\n\t\t\t\tpageSize:10,\n\t\t\t\tpageIndex:this.curPage.page\n\t\t\t}, (res) => {\n\t\t\t\tthis.loading = false;\n\t\t\t\tif (res.code == 1) {\n\t\t\t\t\tthis.apiList = res.data;\n\t\t\t\t\tthis.curPage = {\n\t\t\t\t\t\tpage: res.pageIndex,\n\t\t\t\t\t\tsize: res.pageMaxPage\n\t\t\t\t\t};\n\n\t\t\t\t} else {\n\t\t\t\n\t\t\t\t\tconsole.log('错误错误')\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\thasToken: true\n\t\t\t});\n\n\t\t},\n\n\t}\n}\n",null]}