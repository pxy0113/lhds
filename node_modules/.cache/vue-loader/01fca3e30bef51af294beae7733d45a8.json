{"remainingRequest":"C:\\Users\\pxy\\Downloads\\test\\lhds\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\pxy\\Downloads\\test\\lhds\\src\\components\\common\\Ubox.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\pxy\\Downloads\\test\\lhds\\src\\components\\common\\Ubox.vue","mtime":1574651315627},{"path":"C:\\Users\\pxy\\Downloads\\test\\lhds\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1572955172692},{"path":"C:\\Users\\pxy\\Downloads\\test\\lhds\\node_modules\\babel-loader\\lib\\index.js","mtime":1572955171173},{"path":"C:\\Users\\pxy\\Downloads\\test\\lhds\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1572955172692},{"path":"C:\\Users\\pxy\\Downloads\\test\\lhds\\node_modules\\vue-loader\\lib\\index.js","mtime":1572955240129}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Utils from '@/plugins/cryAes.js'\nimport {\n\tmapActions\n} from 'vuex';\nimport upSvg from '@/img/up.svg'\nimport { scrollMixins } from '@/mixins/scroll.js'\nexport default {\n\tmixins:[scrollMixins],\n\tdata: () => ({\n\t\ttransition: 'scale-transition',\n\t\t\n\t\tloading:true,//控制骨架屏 true表示显示\n\t\t\n\t\tupIcon:upSvg,\n\t\t\n\t\ttarget: '#vRow',\n\t\t\n\t\toptions: {\n\t\t\tduration: 1000,\n\t\t\toffset: 0,\n\t\t\teasing: 'easeInOutCubic'\n\t\t},\n\t\t\n\t\tcurPage: {\n\t\t\tpage: 1,\n\t\t\tsize: 0\n\t\t},\n\t\t\n\t\tvalid:true,\n\n\t\tnews:{\n\t\t\tA1:'',\n\t\t\tA2:'',\n\t\t\tA3:'',\n\t\t\tA4:0.1,\n\t\t\tA5:0\n\t\t},\n\t\t\n\t\tnewsPassword:'',//交易所为OKex时特定字段\n\t\t\n\t\tplace:'',//当前选中的交易所\n\t\t\n\t\titems:[],//交易所对应的买入/卖出费率数据\n\t\t\n\t\taddDialog:false,\n\t\tapiColumns:[\n\t\t\t  {\n\t\t\t\ttext: '名称',\n\t\t\t\talign: 'center',\n\t\t\t\tsortable: false,\n\t\t\t\tvalue: 'exchange',\n\t\t\t  },\n\t\t\t  {\n\t\t\t\ttext: '备注',\n\t\t\t\talign: 'center',\n\t\t\t\tsortable: false,\n\t\t\t\tvalue: 'remark',\n\t\t\t  },\n\t\t\t  {\n\t\t\t\ttext: 'API KEY',\n\t\t\t\talign: 'center',\n\t\t\t\tsortable: false,\n\t\t\t\tvalue: 'key',\n\t\t\t  },\n\t\t\t  {\n\t\t\t\ttext: 'API SECRET',\n\t\t\t\talign: 'center',\n\t\t\t\tsortable: false,\n\t\t\t\tvalue: 'secret',\n\t\t\t  },\n\t\t\t  {\n\t\t\t\ttext: '买入费率(%)',\n\t\t\t\talign: 'center',\n\t\t\t\tsortable: false,\n\t\t\t\tvalue: 'buy',\n\t\t\t  },\n\t\t\t  {\n\t\t\t\ttext: '卖出费率(%)',\n\t\t\t\talign: 'center',\n\t\t\t\tsortable: false,\n\t\t\t\tvalue: 'sell',\n\t\t\t  },\n\t\t\t  {\n\t\t\t\ttext: '操作',\n\t\t\t\talign:'center',\n\t\t\t\tsortable: false,\n\t\t\t\tvalue: 'del'\n\t\t\t  }\n\t\t],\n\t\tapiList:[],\n\n\t\trules: {\n\t\t\trequired: v => !!v || '必填',\n\t\t\tlength: v =>  (v&&v.length <= 68) || '超出长度',\n\t\t\tsize: v => v > 0 || '必须大于0',\n\t\t\tisEmpty: v => /\\S/.test(v) || '不可为空',\n\t\t\tnot: v => !/[\\u4E00-\\u9FA5]/g.test(v) || '不能是中文'\n\t\t},\n\t}),\n\twatch:{\n\t\t\n\t\tplace:{\n\t\t\thandler(newV,oldV){\n\t\t\t\tthis.items.forEach(item =>{\n\t\t\t\t\tif(item.exc == newV){\n\t\t\t\t\t\tthis.news.A4 = item.buy;\n\t\t\t\t\t\tthis.news.A5 = item.sell;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\timmediate:true\n\t\t},\n\t\t\n\t\twssData:{\n\t\t\thandler(nV,oV){\n\t\t\t\tthis.getMessage();\n\t\t\t},\n\t\t\tdeep:true\n\t\t},\n\t\taddDialog:{\n\t\t\thandler(nV,oV){\n\t\t\t\tnV&&this.afterOpen();//mixins不允许滚动\n\t\t\t\t!nV&&this.beforeClose();\n\t\t\t},\n\t\t\timmediate:true\n\t\t}\n\t\t\n\t},\n\t\n\tcomputed:{\n\t\twssData(){//wss传递的消息\n\t\t\treturn this.$store.state.collocationList;\n\t\t}\n\t},\n\tmounted() {\n\t\tif(sessionStorage.apiPublic){\n\t\t\tthis.items = JSON.parse(sessionStorage.apiPublic);\n\t\t\tthis.place = this.items.length>0?this.items[0].exc:'';\n\t\t}else{\n\t\t\t$ax.getTestData('/EasWebUser/getAPIData',{},(res)=> {\n\t\t\t\tif(res.code == 1){\t\t\t\t\n\t\t\t\t\tsessionStorage.apiPublic = JSON.stringify(res.data);\n\t\t\t\t\tthis.items = res.data;\n\t\t\t\t\tthis.place = this.items.length>0?this.items[0].exc:'';\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t\n\t\tthis.getApiList();\n\t},\n\t\n\tbeforeRouteLeave(to,from,next){//路由离开前断开\n\n\t\tthis.$sock.close();\n\t\t\n\t\tnext();//跳转路由\n\t\t\n\t},\n\t\n\tmethods: {\n\t\t\n\t\t...mapActions(['changeLay', 'changeSnack']),\n\t\t\n\t\ttransUpperCase(data){ //交易对转大写\n\t\t\treturn data.toUpperCase();\n\t\t},\n\t\t\n\t\tinputShow(number) { //点击野马\n\t\t\tthis.curPage.page = number;\n\t\t\tthis.$vuetify.goTo(this.target, this.options);//平滑滚动到表头\n\t\t\tthis.getApiList();\n\t\t},\n\n\t\tchangeTime(time) {\n\t\t\treturn this.$utils.timestampToTime(Number(time));\n\t\t},\n\n\t\tgetMessage(){//wss传递的消息\n\t\t\tlet result = this.wssData;\n\t\t\tswitch (result.code){\n\t\t\t\tcase 20013://客户端在线\n\t\t\t\tthis.sendMsgToClient();\n\t\t\t\t\tbreak;\t\n\t\t\t\t\t\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\t\n\t\t},\n\n\t\tdelApi(item){\n\t\t\tthis.$xyDialog({\n\t\t\t\ttitle:'删除API',\n\t\t\t    content: '确定删除吗? 该操作不可撤销',\n\t\t\t    onOk: () => {\n\t\t\t        this.changeLay(true);\n\t\t\t        \n\t\t\t        $ax.getAjaxData('/EasWebUser/delAPI', {\n\t\t\t        \tid: item.id\n\t\t\t        }, (res) => {\n\t\t\t        \tthis.changeLay(false);\n\t\t\t        \tif (res.code == 1) {\n\t\t\t        \t\tlet msg = {\n\t\t\t        \t\t\tstate: true,\n\t\t\t        \t\t\terrorText: {\n\t\t\t        \t\t\t\ttype: 'success',\n\t\t\t        \t\t\t\ttext: '删除成功'\n\t\t\t        \t\t\t}\n\t\t\t        \t\t}\n\t\t\t        \t\tthis.changeSnack(msg);\n\t\t\t        \t\t\n\t\t\t        \t\tlet state = this.$sock.lookState();\n\t\t\t        \t\t\n\t\t\t        \t\tstate==-1?this.$sock.initWebSocket():this.sendMsgToClient();\n\t\t\t        \t\t\n\t\t\t        \t\tlet index = this.apiList.indexOf(item);\n\t\t\t        \n\t\t\t        \t\tsessionStorage.removeItem('collocation');//删除api/rule的时候把存储的旧数据清空\n\t\t\t        \t\t\n\t\t\t        \t\tthis.apiList.splice(index, 1);\n\t\t\t        \t}\n\t\t\t        \n\t\t\t        }, {\n\t\t\t        \thasToken: true\n\t\t\t        });\n\t\t\t     }\n\t\t\t});\n\t\t\t\n\t\t},\n\n\t\tcloseAccount(){\n\t\t\tthis.$refs.form.resetValidation();\n\t\t\tthis.addDialog = false;\n\t\t\tthis.news = this.$options.data().news;\n\t\t\tthis.newsPassword = '';\n\t\t\tthis.place = this.items.length>0?this.items[0].exc:'';\n\t\t},\n\t\t\n\t\taddOneAccount(){//添加新账户\n\t\t\tif (this.$refs.form.validate()) {\n\t\t\t    let other = {\n\t\t\t    \tA0:this.place,\n\t\t\t    \tA6:this.newsPassword,\n\t\t\t    \tA7:0,\n\t\t\t    \tA8:0,\n\t\t\t    \tA9:0,\n\t\t\t    \tA10:0\n\t\t\t    };\n\t\t\t\t\n\t\t\t    let obj = {\n\t\t\t    \texc:this.place,\n\t\t\t    \tremark:this.news.A1,\n\t\t\t    \tdata:Utils.encrypt(JSON.stringify(Object.assign({},this.news,other)))\n\t\t\t    }\n\t\t\t\t\n\t\t\t\tthis.changeLay(true);//loading\n\t\t\t    $ax.getAjaxData('/EasWebUser/addAPI', obj, (res) => {\t\t\t\n\t\t\t    \tthis.changeLay(false);\n\t\t\t    \tif (res.code == 1) {\n\t\t\t    \t\tlet msg = {\n\t\t\t    \t\t\tstate:true,\n\t\t\t    \t\t\terrorText:{\n\t\t\t    \t\t\t\ttype:'success',\n\t\t\t    \t\t\t\ttext:'添加成功'\n\t\t\t    \t\t\t}\n\t\t\t    \t\t}\n\t\t\t    \t\tthis.changeSnack(msg);\n\t\t\t\t\t\t\n\t\t\t\t\t\tlet state = this.$sock.lookState();\n\t\t\t\t\t\t\n\t\t\t\t\t\tstate==-1?this.$sock.initWebSocket():this.sendMsgToClient();\n\t\t\t\t\t\t\n\t\t\t    \t\tthis.addDialog = false;\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.$refs.form.resetValidation();\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.news = this.$options.data().news;\n\t\t\t\t\t\t\n\t\t\t\t\t\tsessionStorage.removeItem('collocation');\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.getApiList();\n\t\t\t    \t}\n\t\t\t    \n\t\t\t    }, {\n\t\t\t    \thasToken: true\n\t\t\t    });\n\t\t\t}\n\t\t\t\n\t\t},\n\n\t\tsendMsgToClient(){\n\t\t\t\n\t\t\tthis.$sock.websocketsend(JSON.stringify({code:1006}));\n\t\t\t\n\t\t},\n\n\t\tgetApiList(){//获取api列表\n\t\t\tthis.loading = true;\n\t\t\t$ax.getAjaxData('/EasWebUser/getAPI', {\n\t\t\t\tpageSize:10,\n\t\t\t\tpageIndex:this.curPage.page\n\t\t\t}, (res) => {\n\t\t\t\tthis.loading = false;\n\t\t\t\tif (res.code == 1) {\n\t\t\t\t\tthis.apiList = res.data;\n\t\t\t\t\tthis.curPage = {\n\t\t\t\t\t\tpage: res.pageIndex,\n\t\t\t\t\t\tsize: res.pageMaxPage\n\t\t\t\t\t};\n\n\t\t\t\t} else {\n\t\t\t\n\t\t\t\t\tconsole.log('错误错误')\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\thasToken: true\n\t\t\t});\n\n\t\t},\n\n\t}\n}\n",{"version":3,"sources":["Ubox.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA","file":"Ubox.vue","sourceRoot":"src/components/common","sourcesContent":["<template>\r\n\t<!-- <v-container  fluid grid-list-xl> -->\r\n\t\t<div>\r\n\t\t\t\t<v-card outlined id=\"vRow\">\r\n\t\t\t\t\t\r\n\t\t\t\t\t<p class=\"pa-2 ma-0 green lighten-5 d-flex justify-space-between align-center\" >\r\n\t\t\t\t\t\t<span class=\"green--text\">API列表</span>\r\n\t\t\t\t\t\t<v-btn color=\"green\" small\r\n\t\t\t\t\t\toutlined @click=\"addDialog= true\">添加API</v-btn>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<v-divider></v-divider>\r\n\t\t\t\t\t\t<component :is=\"transition !== 'None' ? `v-${transition}` : 'div'\"  hide-on-leave>\r\n\t\t\t\t\t\t\t<v-skeleton-loader\r\n\t\t\t\t\t\t\tv-if=\"loading\"\r\n\t\t\t\t\t\t\ttype=\"article\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t</v-skeleton-loader>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<div v-else>\r\n\t\t\t\t\t\t\t\t<v-list-item three-line class=\"xy-tableItem\" v-if=\"apiList.length<1\">\r\n\t\t\t\t\t\t\t\t\t<p class=\"text-center\" style=\"width: 100%;\">暂无数据</p>\r\n\t\t\t\t\t\t\t\t</v-list-item>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<div v-for=\"(item,index) in apiList\" :key=\"index\" v-else>\r\n\t\t\t\t\t\t\t\t\t<v-list-item three-line style=\"border-bottom: 1px solid #ccc;\">\r\n\t\t\t\t\t\t\t\t\t  <v-list-item-content class=\"align-self-start\">\r\n\t\t\t\t\t\t\t\t\t\t<v-list-item-title\r\n\t\t\t\t\t\t\t\t\t\t  class=\" mb-2\">\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"d-flex align-center justify-space-between\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\" font-weight-bold\">{{transUpperCase(item.remark)}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span style=\"font-size: 12px;\" class=\"font-weight-light\">/{{item.exchange}}</span> </span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<!-- <v-btn color=\"success\" text small  @click=\"delApi(item)\">删除</v-btn> -->\r\n\t\t\t\t\t\t\t\t\t\t\t\t<v-icon color=\"error\" @click=\"delApi(item)\">mdi-delete</v-icon>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</v-list-item-title>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t<div class='font-weight-regular body-2'>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"d-flex justify-space-between flex-wrap align-center \">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"pr-3 py-1 d-flex flex-wrap align-center justify-space-between\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>买入费率(%)：</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>{{item.buy}}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"pr-3 py-1 d-flex flex-wrap align-center justify-space-between\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>卖出费率(%)：</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>{{item.sell}}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\"d-flex justify-space-between flex-wrap align-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"pr-3 py-1 d-flex flex-wrap align-center justify-space-between\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>API_KEY：</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>{{item.key}}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"pr-3 py-1 d-flex flex-wrap align-center justify-space-between\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>API_SECRET：</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>{{item.secret}}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t  </v-list-item-content>\r\n\t\t\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t\t\t</v-list-item>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div class=\"text-center my-2\">\r\n\t\t\t\t\t\t\t\t\t<v-pagination color=\"green\" v-model=\"curPage.page\" :length=\"curPage.size\" v-on:input=\"inputShow\" :total-visible=\"5\"></v-pagination>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t</component>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</v-card>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<v-dialog v-model=\"addDialog\" width=\"500\" persistent>\r\n\t\t\t\t\t\t<v-card>\r\n\t\t\t\t\t\t\t<v-card-title class=\"headline grey lighten-2\" primary-title>\r\n\t\t\t\t\t\t\t\t添加账户\r\n\t\t\t\t\t\t\t</v-card-title>\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t<v-card-text>\r\n\t\t\t\t\t\t\t\t\t<v-form    \r\n\t\t\t\t\t\t\t\t\tref=\"form\"\r\n\t\t\t\t\t\t\t\t\tv-model=\"valid\"\r\n\t\t\t\t\t\t\t\t\tlazy-validation>\r\n\t\t\t\t\t\t\t\t\t\t<v-select\r\n\t\t\t\t\t\t\t\t\t\t\tv-model=\"place\"\r\n\t\t\t\t\t\t\t\t\t\t\t:rules=\"[v => !!v || '必填']\"\r\n\t\t\t\t\t\t\t\t\t\t\t:items=\"items\"\r\n\t\t\t\t\t\t\t\t\t\t\titem-text=\"exc\"\r\n\t\t\t\t\t\t\t\t\t\t\titem-value=\"exc\"\r\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"green\"\r\n\t\t\t\t\t\t\t\t\t\t\titem-color=\"green\"\r\n\t\t\t\t\t\t\t\t\t\t\tlabel=\"交易所\"\r\n\t\t\t\t\t\t\t\t\t\t\tsingle-line>\r\n\t\t\t\t\t\t\t\t\t\t\t<template v-slot:label>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span style=\"font-size: 14px;\">交易所</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t\t\t\t </v-select>\r\n\t\t\t\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t\t\t\t<v-text-field\r\n\t\t\t\t\t\t\t\t\t\t   v-model=\"news.A1\"\r\n\t\t\t\t\t\t\t\t\t\t   label=\"账户备注名称\"\r\n\t\t\t\t\t\t\t\t\t\t   :rules=\"[rules.required,rules.isEmpty]\"\r\n\t\t\t\t\t\t\t\t\t\t   required\r\n\t\t\t\t\t\t\t\t\t\t   color=\"green\"\r\n\t\t\t\t\t\t\t\t\t\t ></v-text-field>\r\n\t\t\t\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t\t\t\t<v-text-field\r\n\t\t\t\t\t\t\t\t\t\tv-model=\"news.A2\"\r\n\t\t\t\t\t\t\t\t\t\t:rules=\"[rules.required,rules.isEmpty,rules.not]\"\r\n\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\tcolor=\"green\"\r\n\t\t\t\t\t\t\t\t\t\tlabel=\"API_KEY\"\r\n\t\t\t\t\t\t\t\t\t\t></v-text-field>\r\n\t\t\t\t\t\t\t\t\t\t  \r\n\t\t\t\t\t\t\t\t\t\t<v-text-field\r\n\t\t\t\t\t\t\t\t\t\t v-model=\"news.A3\"\r\n\t\t\t\t\t\t\t\t\t\t :rules=\"[rules.required,rules.isEmpty,rules.not,rules.length]\"\r\n\t\t\t\t\t\t\t\t\t\t required\r\n\t\t\t\t\t\t\t\t\t\t color=\"green\"\r\n\t\t\t\t\t\t\t\t\t\t label=\"API_SECRET\"\r\n\t\t\t\t\t\t\t\t\t\t></v-text-field>\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t<v-row>\r\n\t\t\t\t\t\t\t\t\t\t\t<v-col cols=\"6\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<v-text-field\r\n\t\t\t\t\t\t\t\t\t\t\t\t   v-model=\"news.A4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t   label=\"买入费率(%)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t   min=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t   max=\"100\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t   step=\"0.1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t   :rules=\"[v => (!!v&&v>=0&&v<=100) || '必填,不是负数且不能大于100']\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t   required\r\n\t\t\t\t\t\t\t\t\t\t\t\t   color=\"green\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t   type=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t ></v-text-field>\r\n\t\t\t\t\t\t\t\t\t\t\t</v-col>\r\n\t\t\t\t\t\t\t\t\t\t\t<v-col cols=\"6\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<v-text-field\r\n\t\t\t\t\t\t\t\t\t\t\t\t   v-model=\"news.A5\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t   label=\"卖出费率(%)\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t   min=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t   step=\"0.1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t   max=\"100\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t   color=\"green\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t   :rules=\"[v => (!!v&&v>=0&&v<=100) || '必填,不是负数且不能大于100']\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t   required\r\n\t\t\t\t\t\t\t\t\t\t\t\t   type=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t ></v-text-field>\r\n\t\t\t\t\t\t\t\t\t\t\t</v-col>\r\n\t\t\t\t\t\t\t\t\t\t</v-row>\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t<v-text-field\r\n\t\t\t\t\t\t\t\t\t\t\tv-if=\"place=='OKEx'\"\r\n\t\t\t\t\t\t\t\t\t\t   v-model=\"newsPassword\"\r\n\t\t\t\t\t\t\t\t\t\t   :rules=\"[rules.required,rules.isEmpty,rules.not]\"\r\n\t\t\t\t\t\t\t\t\t\t   required\r\n\t\t\t\t\t\t\t\t\t\t   color=\"green\"\r\n\t\t\t\t\t\t\t\t\t\t   label=\"PASSPHPASE\"\r\n\t\t\t\t\t\t\t\t\t\t   type=\"password\"\r\n\t\t\t\t\t\t\t\t\t\t ></v-text-field>\r\n\t\t\t\t\t\t\t\t\t</v-form>\r\n\t\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t</v-card-text>\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\t<v-card-actions>\r\n\t\t\t\t\t\t\t\t<div class=\"flex-grow-1\"></div>\r\n\t\t\t\t\t\t\t\t<v-btn color=\"green\" text @click=\"closeAccount\">\r\n\t\t\t\t\t\t\t\t\t关闭\r\n\t\t\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t\t\t\t<v-btn color=\"green\" text @click=\"addOneAccount\">\r\n\t\t\t\t\t\t\t\t\t确定\r\n\t\t\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t\t\t</v-card-actions>\r\n\t\t\t\t\t\t</v-card>\r\n\t\t\t\t\t</v-dialog>\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\r\n\t\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport Utils from '@/plugins/cryAes.js'\r\n\timport {\r\n\t\tmapActions\r\n\t} from 'vuex';\r\n\timport upSvg from '@/img/up.svg'\r\n\timport { scrollMixins } from '@/mixins/scroll.js'\r\n\texport default {\r\n\t\tmixins:[scrollMixins],\r\n\t\tdata: () => ({\r\n\t\t\ttransition: 'scale-transition',\r\n\t\t\t\r\n\t\t\tloading:true,//控制骨架屏 true表示显示\r\n\t\t\t\r\n\t\t\tupIcon:upSvg,\r\n\t\t\t\r\n\t\t\ttarget: '#vRow',\r\n\t\t\t\r\n\t\t\toptions: {\r\n\t\t\t\tduration: 1000,\r\n\t\t\t\toffset: 0,\r\n\t\t\t\teasing: 'easeInOutCubic'\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tcurPage: {\r\n\t\t\t\tpage: 1,\r\n\t\t\t\tsize: 0\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tvalid:true,\r\n\r\n\t\t\tnews:{\r\n\t\t\t\tA1:'',\r\n\t\t\t\tA2:'',\r\n\t\t\t\tA3:'',\r\n\t\t\t\tA4:0.1,\r\n\t\t\t\tA5:0\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tnewsPassword:'',//交易所为OKex时特定字段\r\n\t\t\t\r\n\t\t\tplace:'',//当前选中的交易所\r\n\t\t\t\r\n\t\t\titems:[],//交易所对应的买入/卖出费率数据\r\n\t\t\t\r\n\t\t\taddDialog:false,\r\n\t\t\tapiColumns:[\r\n\t\t\t\t  {\r\n\t\t\t\t\ttext: '名称',\r\n\t\t\t\t\talign: 'center',\r\n\t\t\t\t\tsortable: false,\r\n\t\t\t\t\tvalue: 'exchange',\r\n\t\t\t\t  },\r\n\t\t\t\t  {\r\n\t\t\t\t\ttext: '备注',\r\n\t\t\t\t\talign: 'center',\r\n\t\t\t\t\tsortable: false,\r\n\t\t\t\t\tvalue: 'remark',\r\n\t\t\t\t  },\r\n\t\t\t\t  {\r\n\t\t\t\t\ttext: 'API KEY',\r\n\t\t\t\t\talign: 'center',\r\n\t\t\t\t\tsortable: false,\r\n\t\t\t\t\tvalue: 'key',\r\n\t\t\t\t  },\r\n\t\t\t\t  {\r\n\t\t\t\t\ttext: 'API SECRET',\r\n\t\t\t\t\talign: 'center',\r\n\t\t\t\t\tsortable: false,\r\n\t\t\t\t\tvalue: 'secret',\r\n\t\t\t\t  },\r\n\t\t\t\t  {\r\n\t\t\t\t\ttext: '买入费率(%)',\r\n\t\t\t\t\talign: 'center',\r\n\t\t\t\t\tsortable: false,\r\n\t\t\t\t\tvalue: 'buy',\r\n\t\t\t\t  },\r\n\t\t\t\t  {\r\n\t\t\t\t\ttext: '卖出费率(%)',\r\n\t\t\t\t\talign: 'center',\r\n\t\t\t\t\tsortable: false,\r\n\t\t\t\t\tvalue: 'sell',\r\n\t\t\t\t  },\r\n\t\t\t\t  {\r\n\t\t\t\t\ttext: '操作',\r\n\t\t\t\t\talign:'center',\r\n\t\t\t\t\tsortable: false,\r\n\t\t\t\t\tvalue: 'del'\r\n\t\t\t\t  }\r\n\t\t\t],\r\n\t\t\tapiList:[],\r\n\r\n\t\t\trules: {\r\n\t\t\t\trequired: v => !!v || '必填',\r\n\t\t\t\tlength: v =>  (v&&v.length <= 68) || '超出长度',\r\n\t\t\t\tsize: v => v > 0 || '必须大于0',\r\n\t\t\t\tisEmpty: v => /\\S/.test(v) || '不可为空',\r\n\t\t\t\tnot: v => !/[\\u4E00-\\u9FA5]/g.test(v) || '不能是中文'\r\n\t\t\t},\r\n\t\t}),\r\n\t\twatch:{\r\n\t\t\t\r\n\t\t\tplace:{\r\n\t\t\t\thandler(newV,oldV){\r\n\t\t\t\t\tthis.items.forEach(item =>{\r\n\t\t\t\t\t\tif(item.exc == newV){\r\n\t\t\t\t\t\t\tthis.news.A4 = item.buy;\r\n\t\t\t\t\t\t\tthis.news.A5 = item.sell;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\timmediate:true\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\twssData:{\r\n\t\t\t\thandler(nV,oV){\r\n\t\t\t\t\tthis.getMessage();\r\n\t\t\t\t},\r\n\t\t\t\tdeep:true\r\n\t\t\t},\r\n\t\t\taddDialog:{\r\n\t\t\t\thandler(nV,oV){\r\n\t\t\t\t\tnV&&this.afterOpen();//mixins不允许滚动\r\n\t\t\t\t\t!nV&&this.beforeClose();\r\n\t\t\t\t},\r\n\t\t\t\timmediate:true\r\n\t\t\t}\r\n\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\tcomputed:{\r\n\t\t\twssData(){//wss传递的消息\r\n\t\t\t\treturn this.$store.state.collocationList;\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tif(sessionStorage.apiPublic){\r\n\t\t\t\tthis.items = JSON.parse(sessionStorage.apiPublic);\r\n\t\t\t\tthis.place = this.items.length>0?this.items[0].exc:'';\r\n\t\t\t}else{\r\n\t\t\t\t$ax.getTestData('/EasWebUser/getAPIData',{},(res)=> {\r\n\t\t\t\t\tif(res.code == 1){\t\t\t\t\r\n\t\t\t\t\t\tsessionStorage.apiPublic = JSON.stringify(res.data);\r\n\t\t\t\t\t\tthis.items = res.data;\r\n\t\t\t\t\t\tthis.place = this.items.length>0?this.items[0].exc:'';\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.getApiList();\r\n\t\t},\r\n\t\t\r\n\t\tbeforeRouteLeave(to,from,next){//路由离开前断开\r\n\r\n\t\t\tthis.$sock.close();\r\n\t\t\t\r\n\t\t\tnext();//跳转路由\r\n\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\tmethods: {\r\n\t\t\t\r\n\t\t\t...mapActions(['changeLay', 'changeSnack']),\r\n\t\t\t\r\n\t\t\ttransUpperCase(data){ //交易对转大写\r\n\t\t\t\treturn data.toUpperCase();\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tinputShow(number) { //点击野马\r\n\t\t\t\tthis.curPage.page = number;\r\n\t\t\t\tthis.$vuetify.goTo(this.target, this.options);//平滑滚动到表头\r\n\t\t\t\tthis.getApiList();\r\n\t\t\t},\r\n\r\n\t\t\tchangeTime(time) {\r\n\t\t\t\treturn this.$utils.timestampToTime(Number(time));\r\n\t\t\t},\r\n\r\n\t\t\tgetMessage(){//wss传递的消息\r\n\t\t\t\tlet result = this.wssData;\r\n\t\t\t\tswitch (result.code){\r\n\t\t\t\t\tcase 20013://客户端在线\r\n\t\t\t\t\tthis.sendMsgToClient();\r\n\t\t\t\t\t\tbreak;\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t},\r\n\r\n\t\t\tdelApi(item){\r\n\t\t\t\tthis.$xyDialog({\r\n\t\t\t\t\ttitle:'删除API',\r\n\t\t\t\t    content: '确定删除吗? 该操作不可撤销',\r\n\t\t\t\t    onOk: () => {\r\n\t\t\t\t        this.changeLay(true);\r\n\t\t\t\t        \r\n\t\t\t\t        $ax.getAjaxData('/EasWebUser/delAPI', {\r\n\t\t\t\t        \tid: item.id\r\n\t\t\t\t        }, (res) => {\r\n\t\t\t\t        \tthis.changeLay(false);\r\n\t\t\t\t        \tif (res.code == 1) {\r\n\t\t\t\t        \t\tlet msg = {\r\n\t\t\t\t        \t\t\tstate: true,\r\n\t\t\t\t        \t\t\terrorText: {\r\n\t\t\t\t        \t\t\t\ttype: 'success',\r\n\t\t\t\t        \t\t\t\ttext: '删除成功'\r\n\t\t\t\t        \t\t\t}\r\n\t\t\t\t        \t\t}\r\n\t\t\t\t        \t\tthis.changeSnack(msg);\r\n\t\t\t\t        \t\t\r\n\t\t\t\t        \t\tlet state = this.$sock.lookState();\r\n\t\t\t\t        \t\t\r\n\t\t\t\t        \t\tstate==-1?this.$sock.initWebSocket():this.sendMsgToClient();\r\n\t\t\t\t        \t\t\r\n\t\t\t\t        \t\tlet index = this.apiList.indexOf(item);\r\n\t\t\t\t        \r\n\t\t\t\t        \t\tsessionStorage.removeItem('collocation');//删除api/rule的时候把存储的旧数据清空\r\n\t\t\t\t        \t\t\r\n\t\t\t\t        \t\tthis.apiList.splice(index, 1);\r\n\t\t\t\t        \t}\r\n\t\t\t\t        \r\n\t\t\t\t        }, {\r\n\t\t\t\t        \thasToken: true\r\n\t\t\t\t        });\r\n\t\t\t\t     }\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t},\r\n\r\n\t\t\tcloseAccount(){\r\n\t\t\t\tthis.$refs.form.resetValidation();\r\n\t\t\t\tthis.addDialog = false;\r\n\t\t\t\tthis.news = this.$options.data().news;\r\n\t\t\t\tthis.newsPassword = '';\r\n\t\t\t\tthis.place = this.items.length>0?this.items[0].exc:'';\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\taddOneAccount(){//添加新账户\r\n\t\t\t\tif (this.$refs.form.validate()) {\r\n\t\t\t\t    let other = {\r\n\t\t\t\t    \tA0:this.place,\r\n\t\t\t\t    \tA6:this.newsPassword,\r\n\t\t\t\t    \tA7:0,\r\n\t\t\t\t    \tA8:0,\r\n\t\t\t\t    \tA9:0,\r\n\t\t\t\t    \tA10:0\r\n\t\t\t\t    };\r\n\t\t\t\t\t\r\n\t\t\t\t    let obj = {\r\n\t\t\t\t    \texc:this.place,\r\n\t\t\t\t    \tremark:this.news.A1,\r\n\t\t\t\t    \tdata:Utils.encrypt(JSON.stringify(Object.assign({},this.news,other)))\r\n\t\t\t\t    }\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.changeLay(true);//loading\r\n\t\t\t\t    $ax.getAjaxData('/EasWebUser/addAPI', obj, (res) => {\t\t\t\r\n\t\t\t\t    \tthis.changeLay(false);\r\n\t\t\t\t    \tif (res.code == 1) {\r\n\t\t\t\t    \t\tlet msg = {\r\n\t\t\t\t    \t\t\tstate:true,\r\n\t\t\t\t    \t\t\terrorText:{\r\n\t\t\t\t    \t\t\t\ttype:'success',\r\n\t\t\t\t    \t\t\t\ttext:'添加成功'\r\n\t\t\t\t    \t\t\t}\r\n\t\t\t\t    \t\t}\r\n\t\t\t\t    \t\tthis.changeSnack(msg);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlet state = this.$sock.lookState();\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tstate==-1?this.$sock.initWebSocket():this.sendMsgToClient();\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t    \t\tthis.addDialog = false;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis.$refs.form.resetValidation();\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis.news = this.$options.data().news;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tsessionStorage.removeItem('collocation');\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis.getApiList();\r\n\t\t\t\t    \t}\r\n\t\t\t\t    \r\n\t\t\t\t    }, {\r\n\t\t\t\t    \thasToken: true\r\n\t\t\t\t    });\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t},\r\n\r\n\t\t\tsendMsgToClient(){\r\n\t\t\t\t\r\n\t\t\t\tthis.$sock.websocketsend(JSON.stringify({code:1006}));\r\n\t\t\t\t\r\n\t\t\t},\r\n\r\n\t\t\tgetApiList(){//获取api列表\r\n\t\t\t\tthis.loading = true;\r\n\t\t\t\t$ax.getAjaxData('/EasWebUser/getAPI', {\r\n\t\t\t\t\tpageSize:10,\r\n\t\t\t\t\tpageIndex:this.curPage.page\r\n\t\t\t\t}, (res) => {\r\n\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t\tif (res.code == 1) {\r\n\t\t\t\t\t\tthis.apiList = res.data;\r\n\t\t\t\t\t\tthis.curPage = {\r\n\t\t\t\t\t\t\tpage: res.pageIndex,\r\n\t\t\t\t\t\t\tsize: res.pageMaxPage\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\r\n\t\t\t\t\t\tconsole.log('错误错误')\r\n\t\t\t\t\t}\r\n\t\t\t\t}, {\r\n\t\t\t\t\thasToken: true\r\n\t\t\t\t});\r\n\r\n\t\t\t},\r\n\r\n\t\t}\r\n\t}\r\n</script>\r\n<style scoped=\"scoped\">\r\n\t.d{\r\n\t\tfont-size: 14px!important;\r\n\t}\r\n</style>\r\n"]}]}